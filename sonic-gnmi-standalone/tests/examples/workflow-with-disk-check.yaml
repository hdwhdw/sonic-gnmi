apiVersion: sonic.net/v1
kind: UpgradeWorkflow
metadata:
  name: sonic-upgrade-with-disk-check
spec:
  steps:
    # Step 1: Check available disk space before downloading
    - name: check-disk-space
      type: check-disk-space
      params:
        path: "/tmp"
        min_available_mb: 500  # Require at least 500MB free space
    
    # Step 2: Download the package if disk space is sufficient
    - name: download-sonic-image
      type: download
      params:
        url: "http://httpbin.org/bytes/1024"
        filename: "/tmp/test-package.bin"
        md5: "b2ea9f7fcea7a7e1b7c2d5b0e8f5c7f7"
        version: "1.0.0"
        activate: false